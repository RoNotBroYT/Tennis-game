<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Top-Down Tennis</title>
  <style>
    body { margin: 0; background: #4caf50; overflow: hidden; }
    canvas { display: block; margin: 0 auto; background: #1e7c33; }
  </style>
</head>
<body>
<canvas id="game" width="800" height="500"></canvas>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const court = {
  left: 100, right: 700, top: 50, bottom: 450,
  netY: 250
};

const playerSize = 20;
const ballSize = 8;

let player1 = { x: 400, y: 400 };
let player2 = { x: 400, y: 100 }; // AI

let ball = { x: 400, y: 250, vx: 3, vy: 3 };

let keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

function drawCourt() {
  ctx.fillStyle = "#fff";
  ctx.lineWidth = 2;

  // Outer boundaries
  ctx.strokeRect(court.left, court.top, court.right - court.left, court.bottom - court.top);

  // Net
  ctx.beginPath();
  ctx.moveTo(court.left, court.netY);
  ctx.lineTo(court.right, court.netY);
  ctx.stroke();

  // Service boxes
  ctx.beginPath();
  ctx.moveTo((court.left + court.right) / 2, court.top);
  ctx.lineTo((court.left + court.right) / 2, court.bottom);
  ctx.stroke();
}

function drawPlayers() {
  ctx.fillStyle = "blue";
  ctx.beginPath();
  ctx.arc(player1.x, player1.y, playerSize, 0, Math.PI * 2);
  ctx.fill();

  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(player2.x, player2.y, playerSize, 0, Math.PI * 2);
  ctx.fill();
}

function drawBall() {
  ctx.fillStyle = "yellow";
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ballSize, 0, Math.PI * 2);
  ctx.fill();
}

function movePlayers() {
  const speed = 4;
  if (keys["a"]) player1.x -= speed;
  if (keys["d"]) player1.x += speed;
  if (keys["w"]) player1.y -= speed;
  if (keys["s"]) player1.y += speed;

  // Keep player on bottom half
  player1.x = Math.max(court.left, Math.min(court.right, player1.x));
  player1.y = Math.max(court.netY + playerSize, Math.min(court.bottom, player1.y));

  // AI movement
  if (ball.vy < 0 && ball.y < court.netY) {
    if (ball.x < player2.x - 5) player2.x -= 2;
    else if (ball.x > player2.x + 5) player2.x += 2;
  }
  player2.x = Math.max(court.left, Math.min(court.right, player2.x));
}

function moveBall() {
  ball.x += ball.vx;
  ball.y += ball.vy;

  if (ball.x < court.left + ballSize || ball.x > court.right - ballSize) {
    ball.vx *= -1;
  }

  // Bounce off top/bottom (simulate bounce)
  if (ball.y < court.top + ballSize || ball.y > court.bottom - ballSize) {
    ball.vy *= -1;
  }

  // Bounce off players
  let dx1 = ball.x - player1.x;
  let dy1 = ball.y - player1.y;
  if (Math.hypot(dx1, dy1) < playerSize + ballSize && ball.vy > 0) {
    ball.vy *= -1;
    ball.y = player1.y - playerSize - ballSize;
  }

  let dx2 = ball.x - player2.x;
  let dy2 = ball.y - player2.y;
  if (Math.hypot(dx2, dy2) < playerSize + ballSize && ball.vy < 0) {
    ball.vy *= -1;
    ball.y = player2.y + playerSize + ballSize;
  }
}

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawCourt();
  movePlayers();
  moveBall();
  drawPlayers();
  drawBall();
  requestAnimationFrame(update);
}
update();
</script>
</body>
</html>
